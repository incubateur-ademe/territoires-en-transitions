import { ScoreFinalFields } from '@/domain/referentiels';
import { ActionDefinitionEssential, TreeNode } from '../action-definition.dto';
import {
  ActionCategorieEnum,
  ActionDefinition,
} from '../action-definition.table';
import { ActionTypeEnum } from '../action-type.enum';

type ActionDefinitionFields = ActionDefinitionEssential &
  Partial<Pick<ActionDefinition, 'identifiant' | 'nom' | 'categorie'>>;

export const simpleReferentielScoring: TreeNode<
  ActionDefinitionFields & ScoreFinalFields
> = {
  actionId: 'eci',
  points: 100,
  level: 0,
  actionType: ActionTypeEnum.REFERENTIEL,
  actionsEnfant: [
    {
      actionId: 'eci_1',
      identifiant: '1',
      nom: "Définition d'une stratégie globale de la politique économie circulaire et inscription dans le territoire",
      points: 30,
      level: 1,
      actionType: ActionTypeEnum.ACTION,
      actionsEnfant: [
        {
          actionId: 'eci_1.1',
          identifiant: '1.1',
          nom: 'Définir une stratégie globale de la politique Economie Circulaire et assurer un portage politique fort',
          points: 10,
          level: 2,
          actionType: ActionTypeEnum.SOUS_ACTION,
          actionsEnfant: [],
          score: {
            actionId: 'eci_1.1',
            pointReferentiel: 10,
            pointPotentiel: 10,
            pointPotentielPerso: null,
            pointFait: 10,
            pointPasFait: 0,
            pointNonRenseigne: 0,
            pointProgramme: 0,
            concerne: true,
            completedTachesCount: 1,
            totalTachesCount: 1,
            faitTachesAvancement: 1,
            programmeTachesAvancement: 0,
            pasFaitTachesAvancement: 0,
            pasConcerneTachesAvancement: 0,
            desactive: false,
            renseigne: true,
            aStatut: true,
            avancement: 'fait',
          },
          scoresTag: {},
        },
        {
          actionId: 'eci_1.2',
          identifiant: '1.2',
          nom: "Développer une démarche transversale avec l'ensemble des politiques de la collectivité",
          points: 20,
          level: 2,
          actionType: ActionTypeEnum.SOUS_ACTION,
          actionsEnfant: [],
          score: {
            actionId: 'eci_1.2',
            pointReferentiel: 20,
            pointPotentiel: 20,
            pointPotentielPerso: null,
            pointFait: 0,
            pointPasFait: 0,
            pointNonRenseigne: 20,
            pointProgramme: 0,
            concerne: true,
            completedTachesCount: 0,
            totalTachesCount: 1,
            faitTachesAvancement: 0,
            programmeTachesAvancement: 0,
            pasFaitTachesAvancement: 0,
            pasConcerneTachesAvancement: 0,
            desactive: false,
            renseigne: false,
          },
          scoresTag: {},
        },
      ],
      score: {
        actionId: 'eci_1',
        pointReferentiel: 30,
        pointPotentiel: 30,
        pointPotentielPerso: null,
        pointFait: 10,
        pointPasFait: 0,
        pointNonRenseigne: 20,
        pointProgramme: 0,
        concerne: true,
        completedTachesCount: 1,
        totalTachesCount: 2,
        faitTachesAvancement: 1,
        programmeTachesAvancement: 0,
        pasFaitTachesAvancement: 0,
        pasConcerneTachesAvancement: 0,
        desactive: false,
        renseigne: false,
      },
      scoresTag: {},
    },
    {
      actionId: 'eci_2',
      identifiant: '2',
      nom: 'Développement des services de réduction, collecte et valorisation des déchets',
      points: 70,
      level: 1,
      actionType: ActionTypeEnum.ACTION,
      actionsEnfant: [
        {
          actionId: 'eci_2.0',
          identifiant: '2.0',
          nom: 'Respecter la réglementation en matière de prévention de déchets',
          points: 0,
          level: 2,
          actionType: ActionTypeEnum.SOUS_ACTION,
          actionsEnfant: [],
          score: {
            actionId: 'eci_2.0',
            pointReferentiel: 0,
            pointPotentiel: 0,
            pointPotentielPerso: null,
            pointFait: 0,
            pointPasFait: 0,
            pointNonRenseigne: 0,
            pointProgramme: 0,
            concerne: true,
            completedTachesCount: 0,
            totalTachesCount: 1,
            faitTachesAvancement: 0,
            programmeTachesAvancement: 0,
            pasFaitTachesAvancement: 0,
            pasConcerneTachesAvancement: 0,
            desactive: false,
            renseigne: false,
          },
          scoresTag: {},
        },
        {
          actionId: 'eci_2.1',
          identifiant: '2.1',
          nom: 'Mettre en œuvre les actions du PLPDMA',
          points: 65,
          level: 2,
          actionType: ActionTypeEnum.SOUS_ACTION,
          categorie: ActionCategorieEnum.MISE_EN_OEUVRE,
          actionsEnfant: [],
          score: {
            actionId: 'eci_2.1',
            explication: 'Explication de mise en œuvre',
            pointReferentiel: 65,
            pointPotentiel: 65,
            pointPotentielPerso: null,
            pointFait: 0,
            pointPasFait: 0,
            pointNonRenseigne: 65,
            pointProgramme: 0,
            concerne: true,
            completedTachesCount: 0,
            totalTachesCount: 1,
            faitTachesAvancement: 0,
            programmeTachesAvancement: 0,
            pasFaitTachesAvancement: 0,
            pasConcerneTachesAvancement: 0,
            desactive: false,
            renseigne: false,
          },
          preuves: [
            {
              filename: 'preuve1.pdf',
              modifiedAt: '2021-09-01T00:00:00.000Z',
              url: null,
              titre: 'Preuve 1',
              commentaire: 'Commentaire sur la preuve 1',
              fichierId: 1,
              confidentiel: false,
              preuveType: 'complementaire',
            },
            {
              url: 'https://example.com/preuve2.pdf',
              modifiedAt: '2021-09-02T00:00:00.000Z',
              filename: null,
              titre: 'Preuve 2',
              commentaire: 'Commentaire sur la preuve 2',
              fichierId: 2,
              confidentiel: true,
              preuveType: 'complementaire',
            },
          ],
          scoresTag: {},
        },
        {
          actionId: 'eci_2.2',
          identifiant: '2.2',
          nom: "Disposer d'une commission consultative d'élaboration et de suivi (CCES) élargie",
          points: 5,
          level: 2,
          actionType: ActionTypeEnum.SOUS_ACTION,
          actionsEnfant: [],
          score: {
            actionId: 'eci_2.2',
            pointReferentiel: 5,
            pointPotentiel: 5,
            pointPotentielPerso: null,
            pointFait: 0,
            pointPasFait: 0,
            pointNonRenseigne: 5,
            pointProgramme: 0,
            concerne: true,
            completedTachesCount: 0,
            totalTachesCount: 1,
            faitTachesAvancement: 0,
            programmeTachesAvancement: 0,
            pasFaitTachesAvancement: 0,
            pasConcerneTachesAvancement: 0,
            desactive: false,
            renseigne: false,
          },
          scoresTag: {},
        },
      ],
      score: {
        actionId: 'eci_2',
        pointReferentiel: 70,
        pointPotentiel: 70,
        pointPotentielPerso: null,
        pointFait: 0,
        pointPasFait: 0,
        pointNonRenseigne: 70,
        pointProgramme: 0,
        concerne: true,
        completedTachesCount: 0,
        totalTachesCount: 3,
        faitTachesAvancement: 0,
        programmeTachesAvancement: 0,
        pasFaitTachesAvancement: 0,
        pasConcerneTachesAvancement: 0,
        desactive: false,
        renseigne: false,
      },
      scoresTag: {},
    },
  ],
  score: {
    actionId: 'eci',
    pointReferentiel: 100,
    pointPotentiel: 100,
    pointPotentielPerso: null,
    pointFait: 10,
    pointPasFait: 0,
    pointNonRenseigne: 90,
    pointProgramme: 0,
    concerne: true,
    completedTachesCount: 1,
    totalTachesCount: 5,
    faitTachesAvancement: 1,
    programmeTachesAvancement: 0,
    pasFaitTachesAvancement: 0,
    pasConcerneTachesAvancement: 0,
    desactive: false,
    renseigne: false,
  },
  scoresTag: {},
};
