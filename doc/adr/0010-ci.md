# 10. Intégration/déploiement continu

Date : 2025-08-25

## Statut

Proposé

## Contexte

Notre processus d'intégration continue est actuellement basé sur [Earthly](https://github.com/earthly/earthly).

Cette solution avait été initialement choisi pour permettre de développer et tester localement les processus de construction des différentes images Docker de notre solution.

Cependant plusieurs problèmes ont été découverts au fur et à mesure du temps :

- L'intégration avec les GH actions se révèle assez compliqué avec notamment pas mal de duplication dans le passage des variables d'environnement
- Le Earthfile actuel est malgré quelques progrès resté trop monolothique et complexe
- L'exécution des worflows en CI prend beaucoup de temps
- L'[arrêt](https://earthly.dev/blog/shutting-down-earthfiles-cloud/) de la solution payante Earthly Cloud ne laisse présager rien de bon pour la pérennité de l'outil

## Décision

Utiliser les [workflows réutilisables](https://docs.github.com/en/actions/concepts/workflows-and-actions/reusable-workflows#about-reusable-workflows) et les [actions personnalisées](https://docs.github.com/en/actions/concepts/workflows-and-actions/custom-actions) afin de modulariser les différents workflows et de minimiser la duplication de code.

Utiliser [`act`](https://nektosact.com/) pour faciliter leur élaboration et initialiser les environnements de développememt.

## Conséquences

### Positives

- Amélioration de la lisibilité et de la maintenabilité
- Accélération des temps d'exécution en local et en CI

### Négatives

Effort conséquent pour migrer les workflows actuels.

## Alternatives considérées

[Dagger](https://docs.dagger.io/quickstart/ci?sdk=typescript)
